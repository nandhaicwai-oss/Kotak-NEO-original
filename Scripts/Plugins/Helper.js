const delay=t=>new Promise(((e,n)=>{setTimeout((t=>e()),t)})),delayFlex=t=>{let e,n;return{promise:new Promise((function(r,a){n=r,e=setTimeout((t=>r()),t)})),cancel(){e&&(clearTimeout(e),n(),e=null,n=null)}}};var waitMS=2;function parseToNumber(t){return parseFloat(t.split(",").join(""))}function spkiToPEM(t){var e=arrayBufferToString(t);return formatAsPem(window.btoa(e))}function formatAsPem(t){for(var e="-----BEGIN PUBLIC KEY-----\n";t.length>0;)e+=t.substring(0,64)+"\n",t=t.substring(64);return e+"-----END PUBLIC KEY-----"}function hexStringToUint8Array(t){if(t.length%2!=0)throw"Invalid hexString";for(var e=new Uint8Array(t.length/2),n=0;n<t.length;n+=2){var r=parseInt(t.substr(n,2),16);if(NaN==r)throw"Invalid hexString";e[n/2]=r}return e}function bytesToHexString(t){if(!t)return null;t=new Uint8Array(t);for(var e=[],n=0;n<t.length;++n){var r=t[n].toString(16);r.length<2&&(r="0"+r),e.push(r)}return e.join("")}function makeDraggableXDirection(t,e){let n=0,r=0;function a(t){let a=scaleMultiplier||1;t.preventDefault(),n=(r-t.clientX)/a,r=t.clientX,e.style.left=e.offsetLeft-n+"px"}function i(){document.onmouseup=null,document.onmousemove=null}t.onmousedown=function(t){t.preventDefault(),r=t.clientX,document.onmouseup=i,document.onmousemove=a}}function makeDraggable(t){let e=0,n=0,r=0,a=0;function i(i){let o=scaleMultiplier||1;i.preventDefault(),e=(r-i.clientX)/o,n=(a-i.clientY)/o,r=i.clientX,a=i.clientY,t.style.top=t.offsetTop-n+"px",t.style.left=t.offsetLeft-e+"px"}function o(){document.onmouseup=null,document.onmousemove=null}t.onmousedown=function(t){t.preventDefault(),r=t.clientX,a=t.clientY,document.onmouseup=o,document.onmousemove=i}}function ab2str(t){return String.fromCharCode.apply(null,new Uint8Array(t))}function str2ab(t){const e=new ArrayBuffer(t.length),n=new Uint8Array(e);for(let e=0,r=t.length;e<r;e++)n[e]=t.charCodeAt(e);return e}function asciiToUint8Array(t){for(var e=[],n=0;n<t.length;++n)e.push(t.charCodeAt(n));return new Uint8Array(e)}function mathClamp(t,e,n){return Math.max(e,Math.min(t,n))}function getSubBlockHTML(t,e){let n="\x3c!-- "+e+"Start --\x3e",r="\x3c!-- "+e+"End --\x3e";return pos=t.indexOf(n)+n.length,t.substring(pos,t.indexOf(r,pos))}async function querySelectWait(t,e){return new Promise((async(n,r)=>{let a;for(;null==a;)a=t.querySelector(e),await delay(1);n(a)}))}function roundToTick(t,e=.05){return Math.round(t/e)*e}function getDynamicPercent(t,e=.15,n=.25,r=2){const a=e+n/Math.max(t,1);return Math.min(a,r)}function getSimpleProtectedBuyPrice(t,e=.05){return roundToTick(t*(1+getDynamicPercent(t,.15,1,2))+.15,e)}function getSimpleProtectedSellPrice(t,e=.05){let n=t*(1-getDynamicPercent(t,.15,1,.95))-.15;return n<=.05&&(n=.05),roundToTick(n,e)}function getProtectedBuyPrice(t){a=400,b=.9;let e=a*Math.pow(b,t);return e=mathClamp(e,140,500),t*(e/100)}function getProtectedSellPrice(t){a=400,b=.9;let e=a*Math.pow(b,t);e=mathClamp(e,140,500);let n=t/(e/100);return n=Math.max(n,.05),n}async function querySelectFrameWait(t,e,n){return new Promise((async(r,a)=>{let i;for(;null==i;)i=t.contentDocument.querySelector(e),await delay(n);r(i)}))}function logWithTime(...t){(new Date).toLocaleTimeString([],{hour12:!1})}let lastPlusMessageTime;async function plusMessageCheck(t){for(lastPlusMessageTime=(new Date).getTime();;)((new Date).getTime()-lastPlusMessageTime)/1e3>5&&0!=activeMessageCounter&&(activeMessageCounter=0,t.querySelector("#customNoticeLayer").style.top="-8%"),await delay(6050)}let activeMessageCounter=0;async function showPlusMessage(t,e,n){lastPlusMessageTime=(new Date).getTime(),activeMessageCounter++;let r=noticeMessageElement,a=noticeLayerElement;null!=a&&(a.classList.toggle("normal","normal"==n),a.classList.toggle("error","error"==n),a.classList.toggle("info","info"==n),r.innerText=e,a.style.top="-0.5em",await delay(2855),1==activeMessageCounter&&(a.style.top="-3.5em"),activeMessageCounter--)}function openInNewTab(t){window.open(t,"_blank").focus()}function switchMonthDate(t){let e=new Date;return targetDate=new Date(t),e.setDate(targetDate.getMonth()),e.setMonth(targetDate.getDate()),e.setFullYear(targetDate.getFullYear()),e.setHours(targetDate.getHours()),e.setMinutes(targetDate.getMinutes()),e.setSeconds(targetDate.getSeconds()),targetDate}function groupBy(t,e){return t.reduce((function(t,n){return(t[n[e]]=t[n[e]]||[]).push(n),t}),{})}function getISTTimeStamp(){return(new Date).getTime()+198e5}function getFullDateForExcel(t){return t.getUTCDate()+"/"+(t.getUTCMonth()+1)+"/"+t.getUTCFullYear()+" "+t.getUTCHours()+":"+t.getUTCMinutes()+":"+t.getUTCSeconds()}function getFormattedWeeklyDate(t){return(t.getDate()<10?"0":"")+t.getDate()+"-"+(t.getMonth()+1<10?"0":"")+(t.getMonth()+1)+"-"+t.getFullYear()%2e3+" ("+shortWeekDay[t.getDay()]+")"}function randomIntFromInterval(t,e){return Math.floor(Math.random()*(e-t+1)+t)}function getFormattedTimeForChart(t){let e=new Date(1e3*t);return(e.getUTCHours()<10?"0":"")+e.getUTCHours()+":"+(e.getUTCMinutes()<10?"0":"")+e.getUTCMinutes()}function getUTCTimeFormat(t){return(t.getUTCHours()<10?"0":"")+t.getUTCHours()+":"+(t.getUTCMinutes()<10?"0":"")+t.getUTCMinutes()+":"+(t.getUTCSeconds()<10?"0":"")+t.getUTCSeconds()}function getTimeForLog(t){return t.getFullYear()+"/"+(t.getMonth()+1)+"/"+t.getDate()+" "+t.getHours()+":"+t.getMinutes()+":"+t.getSeconds()}function getFormattedTime(t){return t.getHours()+"-"+t.getMinutes()+"-"+t.getSeconds()}function getFormattedDate(t){return t.getDate()+"-"+(t.getMonth()+1)+"-"+t.getFullYear()}function getISOFormattedDate(t){return t.getFullYear()+"-"+(t.getMonth()+1)+"-"+t.getDate()}function getFormattedDateText(t){return t.getDate()+ordinal_suffix_of(t.getDate())+" "+monthNames[t.getMonth()]+" "+t.getFullYear()}function getFormattedDateHTML(t){return isValidDate(t)||(t=new Date),t.getDate()+"<sup>"+ordinal_suffix_of(t.getDate())+"</sup> "+monthNames[t.getMonth()]+" "+t.getFullYear()}const weekday=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortWeekDay=["SUN","MON","TUE","WED","THU","FRI","SAT"],shortMonthNames=["JAN","FEB","MAR","APR","MAY","JUN","JUL","AUG","SEP","OCT","NOV","DEC"],monthNames=["January","February","March","April","May","June","July","August","September","October","November","December"];function ordinal_suffix_of(t){let e=t%10,n=t%100;return 1===e&&11!==n?"st":2===e&&12!==n?"nd":3===e&&13!==n?"rd":"th"}function isJsonString(t){try{JSON.parse(t)}catch(t){return!1}return!0}function inIframe(){try{return window.self!==window.top}catch(t){return!0}}function gcd(t,e){return 0==t?e:gcd(e%t,t)}function findGCD(t,e){let n=t[0];for(let r=1;r<e;r++)if(n=gcd(t[r],n),1==n)return 1;return n}function formatToCompactNumberPNL(t){if(isNaN(t))throw new Error("Invalid input. Please provide a valid number.");let e=Math.abs(t);return e>=1e7?(t/1e7).toFixed(2)+"Cr":e>=1e5?(t/1e5).toFixed(2)+"L":e>=1e3?(t/1e3).toFixed(2)+"K":t.toString()}function formatToCompactNumber(t){if(isNaN(t))throw new Error("Invalid input. Please provide a valid number.");return t>=1e7?(t/1e7).toFixed(2)+"Cr":t>=1e5?(t/1e5).toFixed(2)+"L":t>=1e3?(t/1e3).toFixed(2)+"K":t.toString()}function appendBlockToDiv(t,e){let n=document.createElement("div");n.innerHTML=t,e.append(n.firstChild)}function fromHTML(t,e=!0){if(!(t=e?t.trim():t))return null;const n=document.createElement("template");n.innerHTML=t;const r=n.content.children;return 1===r.length?r[0]:r}function splitNumberIntoEqualSegments(t,e){const n=[];for(;t>0;){const r=Math.min(t,e);n.push(r),t-=r}return n}function blockReplaceAll(t,e){var n=new RegExp(Object.keys(e).join("|"),"gi");return t.replace(n,(function(t){return e[t.toLowerCase()]}))}function distributeNumber(t,e){let n=[],r=Math.floor(t/e),a=t%e;for(let t=0;t<e;t++)n.push(r);for(let t=0;t<a;t++)n[t]++;return n}function cloneRemoveEventListeners(t){let e=t.cloneNode(!0);return t.parentNode.replaceChild(e,t),e}function isValidDate(t){return t instanceof Date&&!isNaN(t)}function getYearDiff(t,e){let n=new Date;return isNaN(Date.parse(t))||(n=t),Math.abs(e-n)/36e5/8760}function GetStrikeProfitY(t,e,n,r){let a=0;return 1==n?a=Math.max(t-e,0)-r:2==n?a=Math.max(e-t,0)-r:3!=n&&4!=n||(a=t-r),a}let indexPriceSnapArray=[.25,.5,.75,1,2,5,10,25,50,75,100,200,250,500,1e3,1500,2e3];function findClosest(t,e){let n=t[0],r=Math.abs(e-n);for(let a=1;a<t.length;a++){let i=t[a],o=Math.abs(e-i);o<r&&(n=i,r=o)}return n}const zeroPad=(t,e)=>String(t).padStart(e,"0"),isHexadecimal=t=>/^[A-F0-9]+$/i.test(t),currentLocale=window.navigator.languages[0],noDecimalFormatter=Intl.NumberFormat("en-IN",{maximumFractionDigits:0,minimumFractionDigits:0}),rupeeZeroDecimalFormatter=Intl.NumberFormat("en-IN",{style:"currency",currency:"INR",maximumFractionDigits:0,minimumFractionDigits:0}),rupeeTwoDecimalFormatter=Intl.NumberFormat("en-IN",{style:"currency",currency:"INR",maximumFractionDigits:2,minimumFractionDigits:2}),rupeePriceFormatter=Intl.NumberFormat("en-IN",{style:"currency",maximumSignificantDigits:4,currency:"INR"}).format;function isAlphaNumericString(t){return/^[a-z0-9]+$/i.test(t)}function logMessageWithTime(t){const e=new Date;String(e.getMinutes()).padStart(2,"0"),String(e.getSeconds()).padStart(2,"0"),String(e.getMilliseconds()).padStart(3,"0")}function convertDateToOnlyMonthFormat(t){const[e,n,r]=t.split("-");return`${["JAN","FEB","MAR","APR","MAY","JUN","JUL","AUG","SEP","OCT","NOV","DEC"][parseInt(n,10)-1]}`}function convertDateToMMMFormat(t){const[e,n,r]=t.split("-");return`${r}-${["JAN","FEB","MAR","APR","MAY","JUN","JUL","AUG","SEP","OCT","NOV","DEC"][parseInt(n,10)-1]}-${e}`}function debounce(t,e){let n;return function(...r){clearTimeout(n),n=setTimeout((()=>t.apply(this,r)),e)}}class RateLimiter{constructor(t,e){this.rate=t,this.interval=e,this.tokens=t,this.lastRefill=Date.now()}async acquire(){for(;this.tokens<=0;)await this._waitForRefill();this.tokens--}_waitForRefill(){return new Promise((t=>{const e=Date.now(),n=e-this.lastRefill;n>=this.interval?(this.tokens=this.rate,this.lastRefill=e,t()):setTimeout((()=>{this.tokens=this.rate,this.lastRefill=Date.now(),t()}),this.interval-n)}))}}class RecentSearches{constructor(t=10){this.maxSize=t,this.searches=[]}addSearch(t){(t=t.trim())&&(this.searches=this.searches.filter((e=>e.toLowerCase()!==t.toLowerCase())),this.searches.unshift(t),this.searches.length>this.maxSize&&this.searches.pop())}getSearches(){return this.searches}clearSearches(){this.searches=[],localStorage.removeItem("recentSearches")}}function base32ToBytes(t){t=t.replace(/=+$/,"").toUpperCase().replace(/[^A-Z2-7]/g,"");const e=[];let n=0,r=0;for(let a=0;a<t.length;a++)r=r<<5|"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567".indexOf(t[a]),n+=5,n>=8&&(n-=8,e.push(r>>n&255));return new Uint8Array(e)}async function generateTOTP(t,{digits:e=6,step:n=30,epoch:r=Date.now(),algorithm:a="SHA-1"}={}){const i=base32ToBytes(t),o=a.toUpperCase(),u=await crypto.subtle.importKey("raw",i,{name:"HMAC",hash:o},!1,["sign"]),c=Math.floor(r/1e3/n),s=new ArrayBuffer(8),l=new DataView(s);l.setUint32(0,Math.floor(c/2**32)),l.setUint32(4,c>>>0);const m=await crypto.subtle.sign("HMAC",u,s),f=new Uint8Array(m),d=15&f[f.length-1];return(((127&f[d])<<24|(255&f[d+1])<<16|(255&f[d+2])<<8|255&f[d+3])%10**e).toString().padStart(e,"0")}async function ungzip(t){const e=new DecompressionStream("gzip"),n=e.writable.getWriter();return n.write(new Uint8Array(t)),n.close(),await new Response(e.readable).text()}function fetchWithTimeout(t,e={},n=1e4){const r=new AbortController,a=setTimeout((()=>r.abort()),n);return fetch(t,{...e,signal:r.signal}).finally((()=>clearTimeout(a)))}async function fetchNetworkCall(t,e,n,r,a){try{let a={headers:n,method:e?"POST":"GET"};r&&(a.body=r);const i=await fetch(t,a);if(i.ok){const t=await i.json();return{ok:i.ok,status:i.status,data:t}}{let t,e;try{t=await i.json()}catch{e=await i.text()}return{ok:!1,status:i.status,error:e,data:t}}}catch(t){return{ok:!1,error:t.message}}}let audioCtx;function playTone({freq:t=800,duration:e=120,type:n="sine",volume:r=.15,ramp:a=!0}={}){audioCtx||(audioCtx=new(window.AudioContext||window.webkitAudioContext)),"suspended"===audioCtx.state&&audioCtx.resume();const i=audioCtx.createOscillator(),o=audioCtx.createGain();i.type=n,i.frequency.value=t;const u=audioCtx.currentTime;o.gain.setValueAtTime(0,u),o.gain.linearRampToValueAtTime(r,u+.01),a?o.gain.exponentialRampToValueAtTime(.001,u+e/1e3):o.gain.setValueAtTime(r,u+e/1e3),i.connect(o),o.connect(audioCtx.destination),i.start(u),i.stop(u+e/1e3)}const torpeoLastCallMap=new Map,TORPEO_COOLDOWN_MS=500;function playTorpeoClip(t){if(!prefNotificationSound.key)return;const e=Date.now();e-(torpeoLastCallMap.get(t)||0)<500||(torpeoLastCallMap.set(t,e),"error"==t?playTone({freq:500,duration:150,type:"square",volume:2}):"orderExecuteBuy"==t?(playTone({freq:800,duration:350,type:"triangle",volume:.8}),setTimeout((()=>{playTone({freq:800,duration:350,type:"triangle",volume:.8})}),90)):"orderExecuteSell"==t&&(playTone({freq:600,duration:350,type:"triangle",volume:.8}),setTimeout((()=>{playTone({freq:600,duration:350,type:"triangle",volume:.8})}),90)))}